<!DOCTYPE html><!--lTdNVAVY8f_RHOF6IdHl_--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/ee3ba8abf48f46d5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/465f799faf41e6df.js"/><script src="/_next/static/chunks/806bdb8e4a6a9b95.js" async=""></script><script src="/_next/static/chunks/f2f58a7e93290fbb.js" async=""></script><script src="/_next/static/chunks/bd1354d7a1b1bf9d.js" async=""></script><script src="/_next/static/chunks/turbopack-e8b4e1b86504c92f.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d2be314c3ece3fbe.js" async=""></script><script src="/_next/static/chunks/dc2be4344c8233f0.js" async=""></script><meta name="next-size-adjust" content=""/><title>Awesome DevSecOps</title><meta name="description" content="A comprehensive guide to DevSecOps practices and implementation"/><meta property="og:title" content="Awesome DevSecOps"/><meta property="og:description" content="A comprehensive guide to DevSecOps practices and implementation"/><meta property="og:url" content="https://awesome-devsecops.example.com/"/><meta property="og:site_name" content="Awesome DevSecOps"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="http://localhost:3000/og-image.png"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Awesome DevSecOps"/><meta name="twitter:description" content="A comprehensive guide to DevSecOps practices and implementation"/><meta name="twitter:image" content="http://localhost:3000/og-image.png"/><meta name="twitter:image:width" content="800"/><meta name="twitter:image:height" content="600"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="inter_5972bc34-module__OU16Qa__className"><div hidden=""><!--$--><!--/$--></div><div class="min-h-screen flex flex-col bg-background text-foreground"><nav class="bg-background border-b border-gray-800 py-4 px-4 sm:px-6 lg:px-8"><div class="max-w-7xl mx-auto"><div class="flex justify-between items-center"><div class="flex-shrink-0 flex items-center"><a class="text-2xl font-bold text-primary" href="/">Awesome DevSecOps</a></div><div class="hidden md:block"><div class="ml-10 flex items-center space-x-8"><a class="text-foreground hover:text-primary transition-colors" href="/">Home</a><a class="text-foreground hover:text-primary transition-colors" href="/roadmap/">Roadmap</a><a href="/learning-roadmap" class="text-foreground hover:text-primary transition-colors">Learning Roadmap</a><a href="/learning-resources" class="text-foreground hover:text-primary transition-colors">Learning Resources</a><a href="/code-examples" class="text-foreground hover:text-primary transition-colors">Code Examples</a><a href="/community" class="text-foreground hover:text-primary transition-colors">Community</a><a href="/tools-directory" class="text-foreground hover:text-primary transition-colors">Tools Directory</a></div></div><div class="md:hidden flex items-center"><button class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none"><svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg><svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div><div class="hidden md:hidden"><div class="px-2 pt-2 pb-3 space-y-1 sm:px-3"><a class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary" href="/">Home</a><a class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary" href="/roadmap/">Roadmap</a><a href="/learning-roadmap" class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary">Learning Roadmap</a><a href="/learning-resources" class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary">Learning Resources</a><a href="/code-examples" class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary">Code Examples</a><a href="/community" class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary">Community</a><a href="/tools-directory" class="block px-3 py-2 rounded-md text-base font-medium text-foreground hover:text-primary">Tools Directory</a></div></div></div></nav><main class="flex-grow py-8 px-4 sm:px-6 lg:px-8"><div class="max-w-7xl mx-auto"><h1 class="text-3xl font-bold mb-2">Code Examples</h1><p class="text-gray-400 mb-8">Practical DevSecOps templates and configurations for secure development pipelines</p><div class="bg-gray-900 text-white p-6 rounded-lg shadow-xl"><div class="mb-8"><h2 class="text-3xl font-bold mb-2">Code Examples</h2><p class="text-gray-400 mb-6">Practical DevSecOps templates and configurations for secure development pipelines</p><div class="mb-6"><input type="text" placeholder="Search examples by title, description, tags, or category..." class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary" value=""/></div><div class="mb-6"><h3 class="text-lg font-semibold mb-3">Categories</h3><div class="flex flex-wrap gap-2"><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">üîÑ</span>GitHub Actions Workflows</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">ü¶ä</span>GitLab CI Templates</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">üß∞</span>Jenkins Pipelines</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">üê≥</span>Docker Security Configurations</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">‚ò∏Ô∏è</span>Kubernetes Security Policies</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">üèóÔ∏è</span>Terraform Security Modules</button><button class="px-3 py-1 rounded-full text-sm flex items-center bg-gray-800 text-gray-300 hover:bg-gray-700"><span class="mr-1">ÌõÖ</span>Pre-commit Hooks</button></div></div><div class="mb-6"><p class="text-gray-400">Showing <span class="font-semibold text-white">14</span> of <span class="font-semibold text-white">14</span> examples</p></div></div><div class="space-y-8"><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üîÑ</span><h3 class="font-bold text-xl">SAST Integration with GitHub Actions</h3></div><p class="text-gray-300 mb-3">GitHub Actions workflow for static application security testing using CodeQL to scan code for vulnerabilities.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SAST</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">CodeQL</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">GitHub Actions</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security Scanning</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">name: CodeQL Analysis

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: &#x27;30 1 * * 0&#x27;

jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    strategy:
      fail-fast: false
      matrix:
        language: [ &#x27;javascript&#x27;, &#x27;python&#x27; ]

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Initialize CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: ${{ matrix.language }}

    - name: Autobuild
      uses: github/codeql-action/autobuild@v3

    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v3
      with:
        category: &quot;/language:${{matrix.language}}&quot;</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Create a .github/workflows/codeql-analysis.yml file in your repository</li><li>Customize the branches and languages according to your project</li><li>Push to trigger the workflow automatically</li><li>View results in the Security tab of your GitHub repository</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üîÑ</span><h3 class="font-bold text-xl">Container Image Scanning Workflow</h3></div><p class="text-gray-300 mb-3">GitHub Actions workflow to scan Docker images for vulnerabilities using Trivy before pushing to registry.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Container Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Trivy</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Docker</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Vulnerability Scanning</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">name: Container Security Scan

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  scan-image:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3

    - name: Build Docker image
      uses: docker/build-push-action@v5
      with:
        context: .
        load: true
        tags: app:test

    - name: Run Trivy vulnerability scanner
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: &#x27;app:test&#x27;
        format: &#x27;sarif&#x27;
        output: &#x27;trivy-results.sarif&#x27;

    - name: Upload Trivy scan results to GitHub Security tab
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: &#x27;trivy-results.sarif&#x27;</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Place this workflow in .github/workflows/container-scan.yml</li><li>Ensure your Dockerfile is in the repository root</li><li>The workflow will automatically scan on pushes and PRs</li><li>Critical vulnerabilities will fail the build</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">ü¶ä</span><h3 class="font-bold text-xl">Dependency Scanning with GitLab CI</h3></div><p class="text-gray-300 mb-3">GitLab CI template for automated dependency vulnerability scanning using various tools based on project type.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Dependency Scanning</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">GitLab CI</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SAST</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">stages:
  - test

include:
  - template: Security/Dependency-Scanning.gitlab-ci.yml

dependency_scanning:
  stage: test
  variables:
    DS_PYTHON_VERSION: 3
    DS_EXCLUDED_PATHS: &#x27;test,docs&#x27;
  rules:
    - if: $CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
  allow_failure: false</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Add this to your .gitlab-ci.yml file</li><li>GitLab will automatically detect your project type</li><li>Results appear in the Security &amp; Compliance dashboard</li><li>Configure excluded paths for better performance</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üß∞</span><h3 class="font-bold text-xl">Jenkins Security Pipeline</h3></div><p class="text-gray-300 mb-3">Complete Jenkins pipeline with integrated security scanning stages including SAST, SCA, and container scanning.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Jenkins</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Pipeline</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SAST</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SCA</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Container Security</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-groovy">pipeline {
    agent any
    
    tools {
        maven &#x27;Maven 3.8.1&#x27;
        nodejs &#x27;NodeJS 16&#x27;
    }
    
    stages {
        stage(&#x27;Checkout&#x27;) {
            steps {
                checkout scm
            }
        }
        
        stage(&#x27;SAST - SonarQube&#x27;) {
            steps {
                withSonarQubeEnv(&#x27;My SonarQube Server&#x27;) {
                    sh &#x27;mvn sonar:sonar&#x27;
                }
            }
        }
        
        stage(&#x27;SCA - Dependency Check&#x27;) {
            steps {
                dependencyCheck additionalArguments: &#x27;--scan .&#x27;, odcInstallation: &#x27;dependency-check&#x27;
                dependencyCheckPublisher pattern: &#x27;**/dependency-check-report.xml&#x27;
            }
        }
        
        stage(&#x27;Build Docker Image&#x27;) {
            steps {
                script {
                    docker.build(&quot;myapp:${env.BUILD_ID}&quot;)
                }
            }
        }
        
        stage(&#x27;Container Security Scan&#x27;) {
            steps {
                sh &#x27;trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:${env.BUILD_ID}&#x27;
            }
        }
        
        stage(&#x27;Deploy&#x27;) {
            when {
                branch &#x27;main&#x27;
            }
            steps {
                sh &#x27;kubectl set image deployment/myapp myapp=myapp:${env.BUILD_ID}&#x27;
            }
        }
    }
    
    post {
        always {
            publishHTML(target: [
                allowMissing: false,
                alwaysLinkToLastBuild: true,
                keepAll: true,
                reportDir: &#x27;target/dependency-check-report&#x27;,
                reportFiles: &#x27;index.html&#x27;,
                reportName: &#x27;Dependency Check Report&#x27;
            ])
        }
    }
}</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Install required Jenkins plugins (SonarQube, Dependency-Check, HTML Publisher)</li><li>Configure SonarQube server in Jenkins global settings</li><li>Adjust tool versions according to your environment</li><li>Modify deployment stage for your specific infrastructure</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üê≥</span><h3 class="font-bold text-xl">Secure Docker Configuration</h3></div><p class="text-gray-300 mb-3">Dockerfile with security best practices including non-root user, multi-stage build, and security scanning.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Docker</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Multi-stage Build</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Non-root User</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-docker"># Multi-stage build for security and size optimization
FROM node:18-alpine AS builder

# Install build dependencies
RUN apk add --no-cache python3 make g++

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

# Production stage with security hardening
FROM node:18-alpine AS production

# Create non-root user
RUN addgroup -g 1001 -S nodejs &amp;&amp; \
    adduser -S nextjs -u 1001

# Install security updates and minimal packages
RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add --no-cache dumb-init

WORKDIR /app

# Copy built application
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY package.json .

# Drop root privileges
USER nextjs

# Security headers
ENV NODE_ENV=production

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD node healthcheck.js

# Use init system to handle signals properly
ENTRYPOINT [&quot;dumb-init&quot;, &quot;--&quot;]
CMD [&quot;node&quot;, &quot;dist/server.js&quot;]</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Replace the application-specific parts with your code</li><li>Ensure healthcheck.js exists in your project</li><li>Scan the built image with Trivy or similar tools</li><li>Consider adding security scanning to your CI pipeline</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">‚ò∏Ô∏è</span><h3 class="font-bold text-xl">Kubernetes Network Security Policy</h3></div><p class="text-gray-300 mb-3">Kubernetes NetworkPolicy to restrict pod-to-pod communication and enhance cluster security.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Kubernetes</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">NetworkPolicy</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Microsegmentation</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: api-security-policy
  namespace: production
spec:
  podSelector:
    matchLabels:
      app: api-server
  policyTypes:
  - Ingress
  - Egress
  ingress:
  # Allow traffic from frontend pods only
  - from:
    - podSelector:
        matchLabels:
          app: frontend
    ports:
    - protocol: TCP
      port: 8080
  # Allow health checks from kubelet
  - from:
    - namespaceSelector:
        matchLabels:
          name: kube-system
    ports:
    - protocol: TCP
      port: 8080
  egress:
  # Allow DNS resolution
  - to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
    ports:
    - protocol: UDP
      port: 53
    - protocol: TCP
      port: 53
  # Allow database connections
  - to:
    - podSelector:
        matchLabels:
          app: database
    ports:
    - protocol: TCP
      port: 5432</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Apply to your namespace with kubectl apply -f network-policy.yaml</li><li>Test connectivity before applying to production</li><li>Gradually tighten policies based on application requirements</li><li>Monitor for blocked legitimate traffic</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üèóÔ∏è</span><h3 class="font-bold text-xl">AWS Security Module with Terraform</h3></div><p class="text-gray-300 mb-3">Terraform module implementing AWS security best practices including VPC, security groups, and IAM policies.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Terraform</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">AWS</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">IAM</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">VPC</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-hcl"># main.tf
module &quot;vpc&quot; {
  source = &quot;terraform-aws-modules/vpc/aws&quot;
  
  name = &quot;secure-vpc&quot;
  cidr = &quot;10.0.0.0/16&quot;
  
  azs             = [&quot;us-west-2a&quot;, &quot;us-west-2b&quot;, &quot;us-west-2c&quot;]
  private_subnets = [&quot;10.0.1.0/24&quot;, &quot;10.0.2.0/24&quot;, &quot;10.0.3.0/24&quot;]
  public_subnets  = [&quot;10.0.101.0/24&quot;, &quot;10.0.102.0/24&quot;, &quot;10.0.103.0/24&quot;]
  
  enable_nat_gateway = true
  single_nat_gateway = false
  
  # Security features
  enable_dns_hostnames = true
  enable_dns_support   = true
}

# Security Groups
resource &quot;aws_security_group&quot; &quot;web_sg&quot; {
  name_prefix = &quot;web-sg&quot;
  description = &quot;Security group for web servers&quot;
  vpc_id      = module.vpc.vpc_id
  
  ingress {
    description = &quot;HTTPS from internet&quot;
    from_port   = 443
    to_port     = 443
    protocol    = &quot;tcp&quot;
    cidr_blocks = [&quot;0.0.0.0/0&quot;]
  }
  
  ingress {
    description = &quot;HTTP redirect to HTTPS&quot;
    from_port   = 80
    to_port     = 80
    protocol    = &quot;tcp&quot;
    cidr_blocks = [&quot;0.0.0.0/0&quot;]
  }
  
  egress {
    from_port   = 0
    to_port     = 0
    protocol    = &quot;-1&quot;
    cidr_blocks = [&quot;0.0.0.0/0&quot;]
  }
  
  tags = {
    Name = &quot;web-security-group&quot;
  }
}

# IAM Role with least privilege
resource &quot;aws_iam_role&quot; &quot;ec2_role&quot; {
  name = &quot;ec2-role&quot;
  
  assume_role_policy = jsonencode({
    Version = &quot;2012-10-17&quot;
    Statement = [
      {
        Action = &quot;sts:AssumeRole&quot;
        Effect = &quot;Allow&quot;
        Principal = {
          Service = &quot;ec2.amazonaws.com&quot;
        }
      }
    ]
  })
}

resource &quot;aws_iam_role_policy&quot; &quot;ec2_policy&quot; {
  name = &quot;ec2-policy&quot;
  role = aws_iam_role.ec2_role.id
  
  policy = jsonencode({
    Version = &quot;2012-10-17&quot;
    Statement = [
      {
        Effect = &quot;Allow&quot;
        Action = [
          &quot;s3:GetObject&quot;,
          &quot;s3:ListBucket&quot;
        ]
        Resource = [
          &quot;arn:aws:s3:::my-app-bucket/*&quot;,
          &quot;arn:aws:s3:::my-app-bucket&quot;
        ]
      },
      {
        Effect = &quot;Allow&quot;
        Action = [
          &quot;logs:CreateLogGroup&quot;,
          &quot;logs:CreateLogStream&quot;,
          &quot;logs:PutLogEvents&quot;
        ]
        Resource = &quot;arn:aws:logs:*:*:*&quot;
      }
    ]
  })
}</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Customize CIDR blocks and regions for your environment</li><li>Review and adjust IAM policies for least privilege</li><li>Test in staging before applying to production</li><li>Regularly audit and update security policies</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">ÌõÖ</span><h3 class="font-bold text-xl">Pre-commit Hook for Secret Detection</h3></div><p class="text-gray-300 mb-3">Pre-commit configuration to detect secrets and sensitive information before commits are made.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Pre-commit</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Secrets Detection</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Git Hooks</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml"># .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: check-added-large-files
      - id: check-case-conflict
      - id: check-json
      - id: check-merge-conflict
      - id: check-symlinks
      - id: check-yaml
      - id: detect-private-key
      - id: end-of-file-fixer
      - id: mixed-line-ending
      - id: trailing-whitespace
  
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: [&#x27;--baseline&#x27;, &#x27;.secrets.baseline&#x27;]
        exclude: package.lock.json
  
  - repo: https://github.com/zricethezav/gitleaks
    rev: v8.16.1
    hooks:
      - id: gitleaks
        args: [--verbose]
  
  - repo: local
    hooks:
      - id: custom-secret-check
        name: Custom Secret Patterns
        entry: ./.hooks/check-secrets.sh
        language: script
        types: [text]
        exclude: &gt;
          (?x)^(.*/)?(
            package-lock.json|
            yarn.lock|
            Gemfile.lock|
            go.sum|
            .secrets.baseline
          )$</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Install pre-commit: pip install pre-commit</li><li>Create .pre-commit-config.yaml with this content</li><li>Run pre-commit install to set up the hooks</li><li>Run pre-commit run --all-files to scan existing files</li><li>Generate baseline: detect-secrets scan &gt; .secrets.baseline</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üîÑ</span><h3 class="font-bold text-xl">SBOM Generation Workflow</h3></div><p class="text-gray-300 mb-3">GitHub Actions workflow to automatically generate Software Bill of Materials using Syft and upload to dependency graph.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SBOM</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Syft</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">SPDX</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Dependency Graph</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Supply Chain Security</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">name: Generate SBOM

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  sbom:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Syft
      uses: anchore/sbom-action/download-syft@v0.14.1
    
    - name: Generate SBOM
      run: |
        syft ${{ github.event.repository.name }}:${{ github.sha }} \
          -o spdx-json \
          --file sbom.spdx.json
    
    - name: Upload SBOM as artifact
      uses: actions/upload-artifact@v3
      with:
        name: sbom
        path: sbom.spdx.json
    
    - name: Upload to Dependency Graph
      if: github.event_name == &#x27;push&#x27;
      uses: advanced-security/spdx-dependency-submission-action@v0.1.0
      with:
        filePath: sbom.spdx.json</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Add this workflow to .github/workflows/sbom.yml</li><li>The workflow generates SPDX-formatted SBOM</li><li>SBOM is uploaded to GitHub&#x27;s dependency graph</li><li>Available in repository&#x27;s Insights &gt; Dependencies tab</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">ü¶ä</span><h3 class="font-bold text-xl">Terraform Security Linting Pipeline</h3></div><p class="text-gray-300 mb-3">CI pipeline configuration for Terraform security scanning using Checkov and TFLint.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Terraform</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Checkov</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">TFLint</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Infrastructure Security</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">stages:
  - validate
  - security
  - plan
  - deploy

variables:
  TF_ROOT: ${CI_PROJECT_DIR}/terraform
  TF_STATE_NAME: ${CI_PROJECT_NAME}

before_script:
  - cd ${TF_ROOT}
  - terraform version
  - terraform init -backend-config=backend.conf

tflint:
  stage: validate
  image:
    name: ghcr.io/terraform-linters/tflint
    entrypoint: [&quot;&quot;]
  script:
    - tflint --init
    - tflint -f compact
  allow_failure: false

checkov:
  stage: security
  image:
    name: bridgecrew/checkov:latest
  script:
    - checkov -d . --quiet --skip-check CKV_AWS_123,CKV_GCP_123
  artifacts:
    reports:
      cobertura: checkov-report.xml
  allow_failure: false

terraform_validate:
  stage: validate
  script:
    - terraform validate
  allow_failure: false

terraform_plan:
  stage: plan
  script:
    - terraform plan -out=tfplan
    - terraform show -json tfplan &gt; tfplan.json
  artifacts:
    paths:
      - ${TF_ROOT}/tfplan
      - ${TF_ROOT}/tfplan.json
    expire_in: 1 week
  only:
    - merge_requests

terraform_apply:
  stage: deploy
  script:
    - terraform apply -auto-approve tfplan
  when: manual
  only:
    - main</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Place in .gitlab-ci.yml in your repository</li><li>Create backend.conf for remote state configuration</li><li>Adjust skip-check codes based on your organization&#x27;s policies</li><li>Review Checkov findings before applying Terraform changes</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üê≥</span><h3 class="font-bold text-xl">Secure Docker Compose Configuration</h3></div><p class="text-gray-300 mb-3">Docker Compose file with security configurations for multi-service applications.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Docker Compose</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Multi-service</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Network Segmentation</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">version: &#x27;3.8&#x27;

services:
  web:
    build:
      context: ./web
      dockerfile: Dockerfile.prod
    ports:
      - &quot;127.0.0.1:3000:3000&quot;
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgresql://user:password@db:5432/myapp
    networks:
      - frontend
      - backend
    volumes:
      - ./logs:/app/logs:rw
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp
    restart: unless-stopped
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:3000/health&quot;]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: myapp
      POSTGRES_USER: user
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
    volumes:
      - db_data:/var/lib/postgresql/data
      - ./init-scripts:/docker-entrypoint-initdb.d:ro
    networks:
      - backend
    secrets:
      - db_password
    read_only: true
    tmpfs:
      - /tmp
      - /var/run/postgresql
    restart: unless-stopped
    healthcheck:
      test: [&quot;CMD-SHELL&quot;, &quot;pg_isready -U user -d myapp&quot;]
      interval: 30s
      timeout: 10s
      retries: 3

  nginx:
    image: nginx:alpine
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./ssl:/etc/nginx/ssl:ro
    networks:
      - frontend
    depends_on:
      - web
    read_only: true
    tmpfs:
      - /var/cache/nginx
      - /var/run
    cap_drop:
      - ALL
    cap_add:
      - CHOWN
      - SETGID
      - SETUID
    restart: unless-stopped

networks:
  frontend:
    driver: bridge
  backend:
    driver: bridge
    internal: true

volumes:
  db_data:

secrets:
  db_password:
    file: ./secrets/db_password.txt</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Create separate secret files for sensitive data</li><li>Use read-only volumes where possible</li><li>Implement network segmentation with internal networks</li><li>Configure proper health checks for all services</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">‚ò∏Ô∏è</span><h3 class="font-bold text-xl">Kubernetes RBAC Security Policy</h3></div><p class="text-gray-300 mb-3">Kubernetes Role-Based Access Control configuration for least privilege principle implementation.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Kubernetes</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">RBAC</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Least Privilege</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: production
  name: deployment-manager
rules:
- apiGroups: [&quot;apps&quot;]
  resources: [&quot;deployments&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;update&quot;, &quot;patch&quot;]
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]
- apiGroups: [&quot;&quot;]
  resources: [&quot;configmaps&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: deployment-manager-binding
  namespace: production
subjects:
- kind: User
  name: developer@example.com
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: deployment-manager
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: monitoring-viewer
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;, &quot;services&quot;, &quot;endpoints&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]
- apiGroups: [&quot;metrics.k8s.io&quot;]
  resources: [&quot;pods&quot;, &quot;nodes&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: monitoring-viewer-binding
subjects:
- kind: ServiceAccount
  name: monitoring-sa
  namespace: monitoring
roleRef:
  kind: ClusterRole
  name: monitoring-viewer
  apiGroup: rbac.authorization.k8s.io
---
# Pod Security Standards
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted-psp
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - &#x27;configMap&#x27;
    - &#x27;emptyDir&#x27;
    - &#x27;projected&#x27;
    - &#x27;secret&#x27;
    - &#x27;downwardAPI&#x27;
    - &#x27;persistentVolumeClaim&#x27;
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: &#x27;MustRunAsNonRoot&#x27;
  seLinux:
    rule: &#x27;RunAsAny&#x27;
  supplementalGroups:
    rule: &#x27;MustRunAs&#x27;
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: &#x27;MustRunAs&#x27;
    ranges:
      - min: 1
        max: 65535
  readOnlyRootFilesystem: true</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Apply RBAC policies gradually, testing permissions</li><li>Use namespaces to isolate different environments</li><li>Regularly audit and rotate service account tokens</li><li>Implement the principle of least privilege</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üß∞</span><h3 class="font-bold text-xl">Jenkins Security Hardening Pipeline</h3></div><p class="text-gray-300 mb-3">Jenkins pipeline with security hardening measures including credential management and security scanning.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Jenkins</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security Hardening</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Secrets Scanning</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Vulnerability Management</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-groovy">pipeline {
    agent any
    
    environment {
        SCAN_ON_FAILURE = &#x27;true&#x27;
        SECURITY_SCAN_TOOL = &#x27;trivy&#x27;
    }
    
    stages {
        stage(&#x27;Security Preparation&#x27;) {
            steps {
                script {
                    // Mask sensitive variables
                    sh &#x27;echo &quot;***MASKED***&quot;&#x27;
                }
            }
        }
        
        stage(&#x27;Code Checkout with Security&#x27;) {
            steps {
                git branch: &#x27;main&#x27;,
                    url: &#x27;https://github.com/example/repo.git&#x27;,
                    credentialsId: &#x27;github-credentials&#x27;
            }
        }
        
        stage(&#x27;Secrets Scanning&#x27;) {
            steps {
                sh &#x27;&#x27;&#x27;
                # Scan for hardcoded secrets
                gitleaks detect --report-format json --report-path gitleaks-report.json || true
                
                # Check for secrets in code
                if [ -f &quot;gitleaks-report.json&quot; ] &amp;&amp; [ &quot;$(jq length gitleaks-report.json)&quot; -gt 0 ]; then
                    echo &quot;SECRETS FOUND! Pipeline will fail.&quot;
                    cat gitleaks-report.json
                    exit 1
                fi
                &#x27;&#x27;&#x27;
            }
        }
        
        stage(&#x27;Dependency Vulnerability Scan&#x27;) {
            steps {
                sh &#x27;&#x27;&#x27;
                # Scan dependencies for vulnerabilities
                case &quot;${LANGUAGE}&quot; in
                    &quot;node&quot;)
                        npm audit --audit-level=high
                        ;;
                    &quot;python&quot;)
                        pip-audit --requirement requirements.txt
                        ;;
                    &quot;java&quot;)
                        mvn dependency-check:check
                        ;;
                esac
                &#x27;&#x27;&#x27;
            }
        }
        
        stage(&#x27;Container Security Scan&#x27;) {
            steps {
                script {
                    docker.image(&#x27;aquasec/trivy:latest&#x27;).inside {
                        sh &#x27;&#x27;&#x27;
                        trivy fs --exit-code 1 --severity HIGH,CRITICAL . || true
                        trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest || true
                        &#x27;&#x27;&#x27;
                    }
                }
            }
        }
        
        stage(&#x27;Security Gate&#x27;) {
            steps {
                script {
                    // Fail pipeline if security issues found
                    def securityIssues = sh(script: &#x27;find . -name &quot;*.sarif&quot; -o -name &quot;*-report.json&quot; | wc -l&#x27;, returnStdout: true).trim()
                    if (securityIssues.toInteger() &gt; 0) {
                        echo &quot;Security issues detected. Check reports for details.&quot;
                        archiveArtifacts artifacts: &#x27;**/*-report.*&#x27;, fingerprint: true
                        if (env.SCAN_ON_FAILURE == &#x27;true&#x27;) {
                            currentBuild.result = &#x27;UNSTABLE&#x27;
                        } else {
                            error &#x27;Security scan failed&#x27;
                        }
                    }
                }
            }
        }
    }
    
    post {
        always {
            // Archive security reports
            archiveArtifacts artifacts: [
                &#x27;**/gitleaks-report.json&#x27;,
                &#x27;**/*dependency-check-report.xml&#x27;,
                &#x27;**/trivy-results.sarif&#x27;
            ].join(&#x27;,&#x27;),
            fingerprint: true,
            allowEmptyArchive: true
        }
        
        failure {
            // Send security alerts
            mail to: &#x27;security-team@example.com&#x27;,
                 subject: &quot;Security Pipeline Failed - ${env.JOB_NAME}&quot;,
                 body: &quot;Security scan failed in job ${env.JOB_NAME} build ${env.BUILD_NUMBER}&quot;
        }
    }
}</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Install required Jenkins plugins (Credentials Binding, Workspace Cleanup)</li><li>Configure credentials in Jenkins credential store</li><li>Adjust security thresholds based on your organization&#x27;s risk tolerance</li><li>Set up notification channels for security alerts</li></ol></div></div></div><div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 hover:border-primary transition-all duration-300"><div class="p-5 border-b border-gray-700"><div class="flex items-start justify-between"><div><div class="flex items-center mb-2"><span class="text-2xl mr-3">üîÑ</span><h3 class="font-bold text-xl">Security Gate Implementation</h3></div><p class="text-gray-300 mb-3">GitHub Actions workflow implementing security gates to prevent merging code with critical vulnerabilities.</p><div class="flex flex-wrap gap-2"><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Security Gate</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">GitHub Actions</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Merge Protection</span><span class="px-2 py-1 bg-blue-900 text-blue-200 text-xs rounded-full">Vulnerability Management</span></div></div></div></div><div class="relative"><div class="absolute top-3 right-3 z-10"><button class="px-3 py-1 bg-gray-700 text-white text-sm rounded hover:bg-gray-600 flex items-center"><span class="mr-1">üìã</span> Copy</button></div><pre class="p-5 bg-gray-900 overflow-x-auto"><code class="language-yaml">name: Security Gate

on:
  pull_request:
    branches: [ main, develop ]
    types: [ opened, synchronize, reopened ]

jobs:
  security-gate:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
      security-events: write
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: &#x27;18&#x27;
        cache: &#x27;npm&#x27;
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run security audit
      run: |
        # Fail on high and critical vulnerabilities
        npm audit --audit-level=high
      continue-on-error: false
    
    - name: SAST Scan
      uses: github/codeql-action/analyze@v3
      with:
        category: &quot;/language:javascript&quot;
    
    - name: Dependency Scanning
      uses: snyk/actions/node@master
      env:
        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      with:
        args: --severity-threshold=high --fail-on=all
    
    - name: Secret Scanning
      uses: gitleaks/gitleaks-action@v2
      with:
        config-path: .gitleaks.toml
    
    - name: Container Scanning (if Dockerfile exists)
      if: hashFiles(&#x27;Dockerfile&#x27;) != &#x27;&#x27;
      run: |
        docker build -t app:test .
        docker run --rm aquasec/trivy image --exit-code 1 --severity HIGH,CRITICAL app:test
    
    - name: Check for security policy compliance
      run: |
        # Custom security checks
        if [ ! -f &quot;SECURITY.md&quot; ]; then
          echo &quot;ERROR: SECURITY.md file is missing&quot;
          exit 1
        fi
        
        # Check for security headers in package.json
        if ! jq -e &#x27;.scripts.&quot;security-check&quot;&#x27; package.json &gt;/dev/null 2&gt;&amp;1; then
          echo &quot;WARNING: No security-check script found in package.json&quot;
        fi
    
    - name: Comment on PR if vulnerabilities found
      if: failure()
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: &#x27;üö® **Security Gate Failed**\n\nCritical security issues were detected. Please address the following:\n\n1. Run `npm audit fix` to fix dependency vulnerabilities\n2. Check CodeQL results in the Security tab\n3. Review Snyk scan results\n4. Remove any hardcoded secrets\n\nThis PR cannot be merged until security issues are resolved.&#x27;
          })
    
    - name: Block merge on security failures
      if: failure()
      run: |
        echo &quot;Security gate failed. Blocking merge.&quot;
        exit 1</code></pre></div><div class="p-5 bg-gray-850 border-t border-gray-700"><h4 class="font-semibold text-lg mb-3 flex items-center"><span class="mr-2">üìò</span> Usage Instructions</h4><div class="prose prose-invert max-w-none"><ol class="list-decimal list-inside space-y-2 text-gray-300"><li>Add this workflow to .github/workflows/security-gate.yml</li><li>Create .gitleaks.toml for custom secret patterns</li><li>Add SNYK_TOKEN secret in GitHub repository settings</li><li>Configure branch protection rules to require this check</li></ol></div></div></div></div></div></div></main><footer class="bg-background border-t border-gray-800 py-8 px-4 sm:px-6 lg:px-8"><div class="max-w-7xl mx-auto"><div class="flex flex-col md:flex-row justify-between items-center"><div class="mb-4 md:mb-0"><h3 class="text-lg font-semibold text-foreground">Awesome DevSecOps</h3><p class="mt-1 text-sm text-gray-400">Secure development practices for modern teams</p></div><div class="flex space-x-6"><a target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition-colors" href="https://github.com">GitHub</a><a class="text-gray-400 hover:text-primary transition-colors" href="#">Privacy</a><a class="text-gray-400 hover:text-primary transition-colors" href="#">Terms</a></div></div><div class="mt-8 pt-8 border-t border-gray-800 text-center"><p class="text-sm text-gray-400">¬© <!-- -->2026<!-- --> Awesome DevSecOps. All rights reserved.</p></div></div></footer></div><!--$--><!--/$--><script src="/_next/static/chunks/465f799faf41e6df.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n4:I[88589,[\"/_next/static/chunks/dc2be4344c8233f0.js\"],\"default\"]\n5:I[33794,[\"/_next/static/chunks/dc2be4344c8233f0.js\"],\"default\"]\n6:I[22016,[\"/_next/static/chunks/dc2be4344c8233f0.js\"],\"\"]\n7:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"OutletBoundary\"]\n8:\"$Sreact.suspense\"\na:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"ViewportBoundary\"]\nc:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"MetadataBoundary\"]\ne:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n:HL[\"/_next/static/chunks/ee3ba8abf48f46d5.css\",\"style\"]\n:HL[\"/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"lTdNVAVY8f_RHOF6IdHl_\",\"c\":[\"\",\"code-examples\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"code-examples\",{\"children\":[\"__PAGE__\",{}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/ee3ba8abf48f46d5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"inter_5972bc34-module__OU16Qa__className\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"min-h-screen flex flex-col bg-background text-foreground\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-grow py-8 px-4 sm:px-6 lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":\"Code Examples\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-400 mb-8\",\"children\":\"Practical DevSecOps templates and configurations for secure development pipelines\"}],[\"$\",\"$L5\",null,{}]]}]}],[\"$\",\"footer\",null,{\"className\":\"bg-background border-t border-gray-800 py-8 px-4 sm:px-6 lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col md:flex-row justify-between items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 md:mb-0\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg font-semibold text-foreground\",\"children\":\"Awesome DevSecOps\"}],[\"$\",\"p\",null,{\"className\":\"mt-1 text-sm text-gray-400\",\"children\":\"Secure development practices for modern teams\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex space-x-6\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"https://github.com\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-gray-400 hover:text-primary transition-colors\",\"children\":\"GitHub\"}],[\"$\",\"$L6\",null,{\"href\":\"#\",\"className\":\"text-gray-400 hover:text-primary transition-colors\",\"children\":\"Privacy\"}],[\"$\",\"$L6\",null,{\"href\":\"#\",\"className\":\"text-gray-400 hover:text-primary transition-colors\",\"children\":\"Terms\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 pt-8 border-t border-gray-800 text-center\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-sm text-gray-400\",\"children\":[\"¬© \",2026,\" Awesome DevSecOps. All rights reserved.\"]}]}]]}]}]]}],[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/dc2be4344c8233f0.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"children\":[\"$\",\"$8\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@9\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$8\",null,{\"name\":\"Next.Metadata\",\"children\":\"$Ld\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"9:null\nd:[[\"$\",\"title\",\"0\",{\"children\":\"Awesome DevSecOps\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A comprehensive guide to DevSecOps practices and implementation\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"Awesome DevSecOps\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"A comprehensive guide to DevSecOps practices and implementation\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:url\",\"content\":\"https://awesome-devsecops.example.com/\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:site_name\",\"content\":\"Awesome DevSecOps\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"http://localhost:3000/og-image.png\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image:height\",\"content\":\"600\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:title\",\"content\":\"Awesome DevSecOps\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:description\",\"content\":\"A comprehensive guide to DevSecOps practices and implementation\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:image\",\"content\":\"http://localhost:3000/og-image.png\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image:height\",\"content\":\"600\"}]]\n"])</script></body></html>